openapi: 3.0.3
info:
  title: E-Learning API
  description: API for managing courses in the e-learning platform
  version: 1.0.0
  contact:
    email: admin@example.com

servers:
  - url: http://localhost:8080/api
    description: Local Development Server

tags:
  - name: Authentication
    description: User authentication operations
  - name: Admin
    description: Administrative operations for user management and system configuration
  - name: Roles
    description: Role management operations for assigning and managing user roles
  - name: User
    description: User profile and account management operations
  - name: Permissions
    description: Permissions management operations for assigning and managing user permissions
  - name: Categories
    description: Course category management operations for creating, updating, and managing course categories
  - name: Hashtags
    description: Hashtag management operations for creating, updating, and managing hashtags
  - name: Courses
    description: Courses management operations for creating, updating, and managing courses
  - name: Topics
    description: Topics management operations for creating, updating, and managing topics
  - name: Lessons
    description: Lessons management operations for creating, updating, and managing lessons
  - name: Coupons
    description: Coupons management operations for creating, updating, and managing coupons
  - name: Banners
    description: Banners management operations for creating, updating, and managing banners
  - name: Followers
    description: Operations about student-instructor following relationships
  - name: Cart
    description: Operations about user's shopping cart
  - name: Previews
    description: Operations about course previews
  - name: Instructors
    description: Instructor management operations for creating, updating, and managing instructors
  - name: Students
    description: Student management operations for creating, updating, and managing students
  - name: Quizzes
    description: Quizzes management operations for creating, updating, and managing quizzes
  - name: Wishlist
    description: Wishlist management operations for creating, updating, and managing wishlists
  - name: Orders
    description: Orders management operations for creating, updating, and managing orders
  - name: Payments
    description: Payments management operations for creating, updating, and managing payments
  - name: Feedback
    description: Feedback management operations for creating, updating, and managing feedbacks
  - name: Comments
    description: Comments management operations for creating, updating, and managing comments
paths:
  /v1/auth/login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticate a user and return access & refresh tokens. Verifies account status based on role (for students, checks verify status; for teachers, checks approval status).
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: user@example.com
                  description: User's email address
                password:
                  type: string
                  format: password
                  example: StrongPassword123!
                  description: User's password
      responses:
        '200':
          description: Successful login
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Login successful
                  data:
                    type: object
                    properties:
                      access_token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      refresh_token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      user:
                        type: object
                        properties:
                          _id:
                            type: string
                            example: 5f7c8f5e6d0e8a1a2c3d4e5f
                          email:
                            type: string
                            example: user@example.com
                          username:
                            type: string
                            example: testuser
                          full_name:
                            type: string
                            example: Test User
                          roles:
                            type: array
                            items:
                              type: string
                            example: ['Student']
                          verify:
                            type: string
                            enum: [Verified, Unverified, Banned]
                            example: Verified
                          is_approved:
                            type: boolean
                            example: true
                          avatar:
                            type: string
                            example: https://example.com/avatar.jpg
        '400':
          description: Bad request - Missing or invalid fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Missing required fields
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        field:
                          type: string
                          example: email
                        message:
                          type: string
                          example: Email is required
        '401':
          description: Unauthorized - Invalid credentials or unverified account
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Invalid email or password
                  error:
                    type: string
                    example: Your account is not verified. Please check your email for verification instructions.
        '402':
          description: Payment Required - Insufficient funds
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Insufficient funds. Please top up your account.
                  data:
                    type: object
                    properties:
                      amount_needed:
                        type: number
                        example: 10.00
                      top_up_url:
                        type: string
                        example: https://example.com/top-up
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Validation failed
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        field:
                          type: string
                          example: email
                        message:
                          type: string
                          example: Invalid email format
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Internal server error

  /v1/auth/register:
    post:
      tags:
        - Authentication
      summary: Register a new user
      description: Register a new user with role-based verification - students require email verification, teachers require admin approval
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - full_name
                - email
                - password
                - confirm_password
                - role
                - date_of_birth
              properties:
                full_name:
                  type: string
                  minLength: 3
                  maxLength: 30
                  description: User's full name
                  example: John Smith
                email:
                  type: string
                  format: email
                  minLength: 5
                  maxLength: 100
                  description: User's email address
                  example: john.smith@example.com
                password:
                  type: string
                  format: password
                  minLength: 8
                  maxLength: 16
                  description: User's password (must include uppercase, lowercase, number, and special character)
                  example: Str0ng!Password
                confirm_password:
                  type: string
                  format: password
                  minLength: 8
                  maxLength: 16
                  description: Password confirmation
                  example: Str0ng!Password
                role:
                  type: string
                  enum: [student, instructor]
                  description: User role (student or instructor)
                  example: student
                date_of_birth:
                  type: string
                  format: date
                  description: User's date of birth (YYYY-MM-DD)
                  example: '1990-01-15'
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Registration successful
                  data:
                    type: object
                    properties:
                      access_token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      refresh_token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      user:
                        type: object
                        properties:
                          _id:
                            type: string
                            example: 5f7c8f5e6d0e8a1a2c3d4e5f
                          email:
                            type: string
                            example: user@example.com
                          username:
                            type: string
                            example: testuser
                          role:
                            type: string
                            example: Student
                          verify:
                            type: string
                            enum: [Verified, Unverified]
                            example: Unverified
                          is_approved:
                            type: boolean
                            example: false
        '400':
          description: Bad request - Missing or invalid fields
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '409':
          description: Conflict - Email or username already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/logout:
    post:
      tags:
        - Authentication
      summary: User logout
      description: Logs out a user by invalidating their refresh token
      operationId: logout
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  description: User's refresh token (optional if sent via cookies)
                  example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  minLength: 30
                  pattern: ^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.[A-Za-z0-9-_.+/=]*$
      responses:
        '200':
          description: Successful logout
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Logged out successfully
                  data:
                    type: string
                    example: ''
        '400':
          description: Bad request - Missing or invalid token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Invalid token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '404':
          description: Not found - Token not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/logout-all:
    post:
      tags:
        - Authentication
      summary: Logout from all devices
      description: Logs out a user from all devices by removing all refresh tokens
      operationId: logoutAllDevices
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Successfully logged out from all devices
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Logged out from all devices successfully
                  data:
                    type: string
                    example: ""
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/forgot-password:
    post:
      tags:
        - Authentication
      summary: Forgot Password
      description: Send password reset OTP to user's email
      operationId: forgotPassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: User's registered email address
                  example: user@example.com
      responses:
        '200':
          description: Password reset OTP sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Check your email to reset your password
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Missing or invalid email
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '404':
          description: Email not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/verify-reset-otp:
    post:
      tags:
        - Authentication
      summary: Verify Reset OTP
      description: Verify password reset OTP validity
      operationId: verifyResetOTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - otp
                - email
              properties:
                otp:
                  type: string
                  description: Password reset OTP
                  example: '123456'
                  minLength: 6
                  maxLength: 6
                email:
                  type: string
                  format: email
                  description: User's email address
                  example: user@example.com
      responses:
        '200':
          description: OTP is valid
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Verify forgot password successfully
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid or expired OTP
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/reset-password:
    post:
      tags:
        - Authentication
      summary: Reset Password
      description: Reset user password with OTP
      operationId: resetPassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - confirm_password
              properties:
                email:
                  type: string
                  format: email
                  description: User's email address
                  example: user@example.com
                password:
                  type: string
                  format: password
                  description: New password
                  example: StrongNewPassword123!
                confirm_password:
                  type: string
                  format: password
                  description: Confirm new password
                  example: StrongNewPassword123!
      responses:
        '200':
          description: Password reset successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Password changed successfully
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid OTP or passwords don't match
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/verify-email:
    post:
      tags:
        - Authentication
      summary: Verify Email OTP
      description: Verify email address with OTP for account activation
      operationId: verifyEmailOTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - otp
                - email
              properties:
                otp:
                  type: string
                  description: Email verification OTP
                  example: '123456'
                  minLength: 6
                  maxLength: 6
                email:
                  type: string
                  format: email
                  description: User's email address
                  example: user@example.com
      responses:
        '200':
          description: Email verification successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Verification email successfully
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid OTP or email
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/resend-otp:
    post:
      tags:
        - Authentication
      summary: Resend OTP
      description: Resend OTP for email verification or password reset
      operationId: resendOTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  description: User's email address
                  example: user@example.com
                type:
                  type: string
                  description: Type of OTP to resend
                  enum: [email_verification, password_reset]
                  example: email_verification
      responses:
        '200':
          description: OTP resent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: OTP has been resent to your email
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid email
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/change-password:
    post:
      tags:
        - Authentication
      summary: Change Password
      description: Change user's password when authenticated
      operationId: changePassword
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - current_password
                - new_password
                - confirm_password
              properties:
                current_password:
                  type: string
                  format: password
                  description: User's current password
                  example: CurrentPassword123!
                new_password:
                  type: string
                  format: password
                  description: User's new password
                  example: NewStrongPassword456!
                confirm_password:
                  type: string
                  format: password
                  description: Confirmation of new password
                  example: NewStrongPassword456!
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Password changed successfully
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Current password incorrect or new password invalid
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/refresh-token:
    post:
      tags:
        - Authentication
      summary: Refresh Tokens
      description: Refresh access and refresh tokens using a valid refresh token
      operationId: refreshToken
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
                  description: User's refresh token (optional if sent via cookies)
                  example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  minLength: 30
                  pattern: ^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.[A-Za-z0-9-_.+/=]*$
      responses:
        '200':
          description: Tokens refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Refresh_token successfully
                  data:
                    type: object
                    properties:
                      access_token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                      refresh_token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '400':
          description: Bad request - Missing token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Invalid or expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '404':
          description: Not found - Token not found in system
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/validate-token:
    post:
      tags:
        - Authentication
      summary: Validate Token
      description: Validate a token and check its expiration status
      operationId: validateToken
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
                - token_type
              properties:
                token:
                  type: string
                  description: Token to validate
                  example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                  minLength: 30
                  pattern: ^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.[A-Za-z0-9-_.+/=]*$
                token_type:
                  type: string
                  description: Type of token
                  enum: [access_token, refresh_token]
                  example: access_token
      responses:
        '200':
          description: Token validation successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Token is valid
                  data:
                    type: object
                    properties:
                      valid:
                        type: boolean
                        example: true
                      expired:
                        type: boolean
                        example: false
                      user_id:
                        type: string
                        example: 5f7c8f5e6d0e8a1a2c3d4e5f
                      email:
                        type: string
                        example: user@example.com
                      token_type:
                        type: string
                        example: AccessToken
        '400':
          description: Bad request - Invalid token format or signature
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Token is expired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/admin/assign-role:
    post:
      tags:
        - Authentication
        - Admin
      summary: Assign Admin Role
      description: Assign admin role to a user (requires admin privileges)
      operationId: assignAdminRole
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_user_id
              properties:
                target_user_id:
                  type: string
                  format: objectId
                  description: ID of the user to be made admin
                  example: 5f7c8f5e6d0e8a1a2c3d4e5f
      responses:
        '200':
          description: Admin role assigned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Admin role assigned successfully
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid user ID or user is not a pro
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/auth/admin/set-pro:
    post:
      tags:
        - Authentication
        - Admin
      summary: Set User as Pro
      description: Set a user as a pro user (requires admin privileges)
      operationId: setUserAsPro
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_user_id
              properties:
                target_user_id:
                  type: string
                  format: objectId
                  description: ID of the user to be made pro
                  example: 5f7c8f5e6d0e8a1a2c3d4e5f
      responses:
        '200':
          description: Pro status assigned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Pro status assigned successfully
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid user ID or user is already pro
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/users/profile:
    get:
      tags:
        - User
      summary: Get User Profile
      description: Retrieve the authenticated user's profile information
      operationId: getUserProfile
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User profile retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Profile retrieved successfully
                  data:
                    $ref: '#/components/schemas/UserProfile'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - User
      summary: Update User Profile
      description: Update authenticated user's profile information
      operationId: updateUserProfile
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserProfileRequest'
      responses:
        '200':
          description: User profile updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Profile updated successfully
                  data:
                    $ref: '#/components/schemas/UserProfile'
        '400':
          description: Bad request - Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/users/profile/avatar:
    post:
      tags:
        - User
      summary: Upload Avatar Image
      description: Upload and update the authenticated user's avatar image
      operationId: uploadUserAvatar
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - avatar
              properties:
                avatar:
                  type: string
                  format: binary
                  description: Avatar image file (JPEG, PNG, WebP, etc.)
      responses:
        '200':
          description: Avatar uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Avatar uploaded successfully
                  data:
                    $ref: '#/components/schemas/UserProfile'
        '400':
          description: Bad request - Invalid file type or size
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/users/profile/cover:
    post:
      tags:
        - User
      summary: Upload Cover Photo
      description: Upload and update the authenticated user's cover photo
      operationId: uploadUserCoverPhoto
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - cover_photo
              properties:
                cover_photo:
                  type: string
                  format: binary
                  description: Cover photo image file (JPEG, PNG, WebP, etc.)
      responses:
        '200':
          description: Cover photo uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Cover photo uploaded successfully
                  data:
                    $ref: '#/components/schemas/UserProfile'
        '400':
          description: Bad request - Invalid file type or size
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/users:
    get:
      tags:
        - Admin
      summary: Get paginated users list
      description: Retrieve a paginated list of users with filtering, sorting, and search capabilities (requires admin privileges)
      operationId: getPaginatedUsers
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number (starts from 1)
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: Number of items per page (max 100)
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: search
          in: query
          description: Search term for filtering by name or email
          required: false
          schema:
            type: string
        - name: search_by
          in: query
          description: Field to search in
          required: false
          schema:
            type: string
            enum: [full_name, email]
            default: full_name
        - name: role
          in: query
          description: Filter by role name
          required: false
          schema:
            type: string
        - name: verify_status
          in: query
          description: Filter by verification status
          required: false
          schema:
            type: integer
            enum: ['Unverified', 'Verified', 'Celerity', 'Banned']
        - name: is_pro
          in: query
          description: Filter by pro user status
          required: false
          schema:
            type: boolean
        - name: sort_by
          in: query
          description: Field to sort by
          required: false
          schema:
            type: string
            enum: [full_name, email, created_at, username]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Users retrieved successfully
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/UserListItem'
                      metadata:
                        type: object
                        properties:
                          total:
                            type: integer
                            example: 100
                          page:
                            type: integer
                            example: 1
                          limit:
                            type: integer
                            example: 10
                          pages:
                            type: integer
                            example: 10
        '400':
          description: Bad request - Invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/reset-password:
    post:
      tags:
        - Admin
      summary: Reset User Password
      description: Allows an admin to reset a user's password (requires admin privileges)
      operationId: adminResetUserPassword
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_user_id
                - new_password
                - confirm_password
              properties:
                target_user_id:
                  type: string
                  description: ID of the user whose password is being reset
                  example: '60d0fe4f5311236168a109ca'
                new_password:
                  type: string
                  format: password
                  description: New password for the user
                  example: 'StrongPassword123!'
                confirm_password:
                  type: string
                  format: password
                  description: Confirmation of new password (must match new_password)
                  example: 'StrongPassword123!'
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'User password has been reset successfully by admin'
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/disable-user:
    post:
      tags:
        - Admin
      summary: Disable User Account
      description: Disable a user account without permanently deleting data (requires admin privileges)
      operationId: disableUserAccount
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_user_id
              properties:
                target_user_id:
                  type: string
                  description: ID of the user to disable
                  example: '60d0fe4f5311236168a109ca'
                reason:
                  type: string
                  description: Optional reason for disabling the account
                  example: 'Violation of terms of service'
      responses:
        '200':
          description: User account disabled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'User account has been disabled successfully'
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid input, already disabled, etc
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin or trying to disable an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/enable-user:
    post:
      tags:
        - Admin
      summary: Enable User Account
      description: Re-enable a previously disabled user account (requires admin privileges)
      operationId: enableUserAccount
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_user_id
              properties:
                target_user_id:
                  type: string
                  description: ID of the user to re-enable
                  example: '60d0fe4f5311236168a109ca'
      responses:
        '200':
          description: User account enabled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'User account has been enabled successfully'
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Invalid input, not disabled, etc
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Not found - User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/roles:
    get:
      tags:
        - Roles
      summary: Get All Roles
      description: Retrieve a list of all available roles in the system
      operationId: getAllRoles
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Roles retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Roles retrieved successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Role'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Roles
      summary: Create Role
      description: Create a new role in the system (requires admin privileges)
      operationId: createRole
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - description
              properties:
                name:
                  type: string
                  description: Role name (must be unique)
                  example: 'INSTRUCTOR'
                description:
                  type: string
                  description: Role description
                  example: 'Can create and manage courses'
                permissions:
                  type: array
                  items:
                    type: string
                  description: List of permission keys associated with this role
                  example: ['create:course', 'edit:course', 'delete:course']
      responses:
        '201':
          description: Role created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role created successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid input or role already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/roles/{id}:
    get:
      tags:
        - Roles
      summary: Get Role Details
      description: Retrieve details of a specific role
      operationId: getRoleDetails
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role to retrieve
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Role retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role retrieved successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Roles
      summary: Update Role
      description: Update an existing role (requires admin privileges)
      operationId: updateRole
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role to update
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Updated role name
                  example: 'SENIOR_INSTRUCTOR'
                description:
                  type: string
                  description: Updated role description
                  example: 'Can create and manage all types of courses'
                permissions:
                  type: array
                  items:
                    type: string
                  description: Updated list of permission keys
                  example: ['create:course', 'edit:course', 'manage:instructors']
      responses:
        '200':
          description: Role updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role updated successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid input or duplicate role name
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin or trying to modify protected role
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Roles
      summary: Delete Role
      description: Delete an existing role (requires admin privileges)
      operationId: deleteRole
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role to delete
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Role deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role deleted successfully'
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Cannot delete system role
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin or trying to delete protected role
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/roles/{roleId}/permissions:
    get:
      tags:
        - Roles
      summary: Get Role Permissions
      description: Retrieve all permissions associated with a role
      operationId: getRolePermissions
      security:
        - BearerAuth: []
      parameters:
        - name: roleId
          in: path
          description: ID of the role
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permissions retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permissions retrieved successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Permission'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Roles
      summary: Update Role Permissions
      description: Update the permissions associated with a role (requires admin privileges)
      operationId: updateRolePermissions
      security:
        - BearerAuth: []
      parameters:
        - name: roleId
          in: path
          description: ID of the role
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - permissions
              properties:
                permissions:
                  type: array
                  items:
                    type: string
                  description: List of permission keys to assign to the role
                  example: ['create:course', 'edit:course', 'view:course', 'delete:course']
      responses:
        '200':
          description: Role permissions updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role permissions updated successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/users/{userId}/roles:
    get:
      tags:
        - Roles
      summary: Get User Roles
      description: Retrieve all roles assigned to a user
      operationId: getUserRoles
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: ID of the user
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User roles retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'User roles retrieved successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Role'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Roles
      summary: Assign Roles to User
      description: Assign roles to a user (requires admin privileges)
      operationId: assignUserRoles
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: ID of the user
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - roleIds
              properties:
                roleIds:
                  type: array
                  items:
                    type: string
                  description: List of role IDs to assign to the user
                  example: ['60d0fe4f5311236168a109cb', '60d0fe4f5311236168a109cc']
      responses:
        '200':
          description: Roles assigned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Roles assigned to user successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid role IDs
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: User or role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Roles
      summary: Remove User Roles
      description: Remove roles from a user (requires admin privileges)
      operationId: removeUserRoles
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: ID of the user
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - roleIds
              properties:
                roleIds:
                  type: array
                  items:
                    type: string
                  description: List of role IDs to remove from the user
                  example: ['60d0fe4f5311236168a109cb']
      responses:
        '200':
          description: Roles removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Roles removed from user successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid role IDs or cannot remove default role
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: User or role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/permissions:
    get:
      tags:
        - Permissions
      summary: Get All Permissions
      description: Retrieve all available permissions in the system
      operationId: getAllPermissions
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Permissions retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permissions retrieved successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Permission'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Permissions
      summary: Create Permission
      description: Create a new permission in the system (requires admin privileges)
      operationId: createPermission
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - key
                - name
                - description
              properties:
                key:
                  type: string
                  description: Unique permission key (e.g., "create:course")
                  example: 'view:analytics'
                name:
                  type: string
                  description: Human-readable permission name
                  example: 'View Analytics'
                description:
                  type: string
                  description: Detailed permission description
                  example: 'Can view analytics and statistics data'
                group:
                  type: string
                  description: Permission group for categorization
                  example: 'Analytics'
      responses:
        '201':
          description: Permission created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission created successfully'
                  data:
                    $ref: '#/components/schemas/Permission'
        '400':
          description: Bad request - Invalid input or permission already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/permissions/{id}:
    get:
      tags:
        - Permissions
      summary: Get Permission Details
      description: Retrieve details of a specific permission
      operationId: getPermissionDetails
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the permission to retrieve
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permission retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission retrieved successfully'
                  data:
                    $ref: '#/components/schemas/Permission'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Permission not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Permissions
      summary: Update Permission
      description: Update an existing permission (requires admin privileges)
      operationId: updatePermission
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the permission to update
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                key:
                  type: string
                  description: Updated permission key
                  example: 'view:advanced:analytics'
                name:
                  type: string
                  description: Updated human-readable permission name
                  example: 'View Advanced Analytics'
                description:
                  type: string
                  description: Updated permission description
                  example: 'Can access and view advanced analytics and reporting features'
                group:
                  type: string
                  description: Updated permission group
                  example: 'Advanced Analytics'
      responses:
        '200':
          description: Permission updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission updated successfully'
                  data:
                    $ref: '#/components/schemas/Permission'
        '400':
          description: Bad request - Invalid input or duplicate key
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin or trying to modify system permission
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Permission not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '422':
          description: Unprocessable Entity - Validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Permissions
      summary: Delete Permission
      description: Delete an existing permission (requires admin privileges)
      operationId: deletePermission
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the permission to delete
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permission deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission deleted successfully'
                  data:
                    type: string
                    example: ""
        '400':
          description: Bad request - Cannot delete system permission
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin or trying to delete system permission
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Permission not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/permissions/groups:
    get:
      tags:
        - Permissions
      summary: Get Permission Groups
      description: Retrieve all permission groups for categorization
      operationId: getPermissionGroups
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Permission groups retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission groups retrieved successfully'
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          example: 'Courses'
                        permissions_count:
                          type: integer
                          example: 12
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/roles/permission-matrix:
    get:
      tags:
        - Permissions
      summary: Get Role-Permission Matrix
      description: Retrieve a matrix showing all roles and their assigned permissions
      operationId: getRolePermissionMatrix
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Role-permission matrix retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role-permission matrix retrieved successfully'
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        role_id:
                          type: string
                          example: '60d0fe4f5311236168a109cb'
                        role_name:
                          type: string
                          example: 'INSTRUCTOR'
                        permissions:
                          type: array
                          items:
                            type: object
                            properties:
                              permission_id:
                                type: string
                                example: '60d0fe4f5311236168a109cd'
                              key:
                                type: string
                                example: 'create:course'
                              group:
                                type: string
                                example: 'Courses'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/users/{userId}/permissions:
    get:
      tags:
        - Permissions
      summary: Get User Permissions
      description: Retrieve all permissions a user has based on their assigned roles
      operationId: getUserPermissions
      security:
        - BearerAuth: []
      parameters:
        - name: userId
          in: path
          description: ID of the user
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User permissions retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'User permissions retrieved successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Permission'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/roles/{id}/permissions:
    get:
      tags:
        - Permissions
      summary: Get Role Permissions
      description: Retrieve all permissions associated with a role
      operationId: getRolePermissions
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permissions retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permissions retrieved successfully'
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Permission'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Permissions
      summary: Update Role Permissions
      description: Update the permissions associated with a role (requires admin privileges)
      operationId: updateRolePermissions
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - permissions
              properties:
                permissions:
                  type: array
                  items:
                    type: string
                  description: List of permission IDs to assign to the role
                  example: ['60d0fe4f5311236168a109cd', '60d0fe4f5311236168a109ce']
      responses:
        '200':
          description: Role permissions updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Role permissions updated successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Permissions
      summary: Add Permission to Role
      description: Add a specific permission to a role (requires admin privileges)
      operationId: addPermissionToRole
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - permissionId
              properties:
                permissionId:
                  type: string
                  description: ID of the permission to add to the role
                  example: '60d0fe4f5311236168a109cf'
      responses:
        '200':
          description: Permission added to role successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission added to role successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Invalid permission ID or permission already assigned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role or permission not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/roles/{id}/permissions/{permissionId}:
    delete:
      tags:
        - Permissions
      summary: Remove Permission from Role
      description: Remove a specific permission from a role (requires admin privileges)
      operationId: removePermissionFromRole
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the role
          required: true
          schema:
            type: string
        - name: permissionId
          in: path
          description: ID of the permission to remove
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permission removed from role successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Permission removed from role successfully'
                  data:
                    $ref: '#/components/schemas/Role'
        '400':
          description: Bad request - Permission not assigned to role or cannot remove required permission
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Not an admin
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Role or permission not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/approve-teacher:
    post:
      tags:
        - Admin
      summary: Approve a teacher account
      description: Approve a teacher account (admin only)
      operationId: approveTeacher
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_user_id
              properties:
                target_user_id:
                  type: string
                  description: ID of the teacher to approve
                  example: 5f7c8f5e6d0e8a1a2c3d4e5f
      responses:
        '200':
          description: Teacher approved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Not found (User not found)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/cleanup-tokens:
    post:
      tags:
        - Admin
      summary: Clean up expired tokens
      description: Clean up expired tokens from the database (admin only)
      operationId: cleanupExpiredTokens
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Tokens cleaned up successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Successfully cleaned up 5 expired tokens
                  data:
                    type: object
                    properties:
                      deletedCount:
                        type: integer
                        example: 5
                        description: Number of expired tokens deleted
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/admin/token-stats:
    get:
      tags:
        - Admin
      summary: Get token statistics
      description: Get statistics about active, removed, and expired tokens (admin only)
      operationId: getTokenStats
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Token statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Token statistics retrieved successfully
                  data:
                    type: object
                    properties:
                      totalActive:
                        type: integer
                        example: 25
                        description: Total number of active tokens
                      totalRemoved:
                        type: integer
                        example: 10
                        description: Total number of revoked tokens
                      totalExpired:
                        type: integer
                        example: 15
                        description: Total number of expired tokens
                      activeByType:
                        type: object
                        description: Count of active tokens by type
                        example:
                          refresh_token: 20
                          access_token: 5
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


      tags:
        - Categories
      summary: Delete a category
      description: Soft delete a category by ID (Admin only). Cannot delete categories with associated courses.
      operationId: deleteCategory
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the category to delete
          required: true
          schema:
            type: string
            format: mongodb-id
      responses:
        '200':
          description: Category deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Category deleted successfully
                  data:
                    type: string
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/categories:
    post:
      tags:
        - Categories
      summary: Create a new product category
      description: Create a new product category with the provided details (Admin only)
      operationId: createProductCategory
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProductCategoryRequest'
      responses:
        '201':
          description: Product category created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product category created successfully
                  data:
                    type: string
                    description: The ID of the created product category
                    example: 5f7c8f5e6d0e8a1a2c3d4e5f
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '409':
          description: Conflict - Category with the same name or slug already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Categories
      summary: Get all product categories
      description: Retrieve a paginated list of all product categories with filtering and sorting options
      operationId: getAllProductCategories
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of categories per page
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          required: false
          schema:
            type: string
            enum: [name, created_at, updated_at]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
        - name: search
          in: query
          description: Search term for filtering categories
          required: false
          schema:
            type: string
        - name: parent_id
          in: query
          description: Filter by parent category ID
          required: false
          schema:
            type: string
            format: mongodb-id
      responses:
        '200':
          description: List of product categories retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product categories retrieved successfully
                  data:
                    type: object
                    properties:
                      categories:
                        type: array
                        items:
                          $ref: '#/components/schemas/ProductCategory'
                      pagination:
                        $ref: '#/components/schemas/Pagination'
        '400':
          description: Bad request (Invalid query parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/categories/search:
    get:
      tags:
        - Categories
      summary: Search product categories
      description: Search product categories based on provided query parameters
      operationId: searchProductCategories
      security:
        - BearerAuth: []
      parameters:
        - name: query
          in: query
          description: Search query for category names or descriptions
          required: true
          schema:
            type: string
            minLength: 2
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
      responses:
        '200':
          description: Search results retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Search results retrieved successfully
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ProductCategory'
        '400':
          description: Bad request (Invalid search query)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/categories/{id}:
    get:
      tags:
        - Categories
      summary: Get product category details
      description: Retrieve details of a specific product category by ID
      operationId: getProductCategoryDetails
      parameters:
        - name: id
          in: path
          description: ID of the product category to retrieve
          required: true
          schema:
            type: string
            format: mongodb-id
      responses:
        '200':
          description: Product category details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product category details retrieved successfully
                  data:
                    $ref: '#/components/schemas/ProductCategory'
        '404':
          description: Product category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Categories
      summary: Update a product category
      description: Update an existing product category with new details (Admin only)
      operationId: updateProductCategory
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the product category to update
          required: true
          schema:
            type: string
            format: mongodb-id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProductCategoryRequest'
      responses:
        '200':
          description: Product category updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product category updated successfully
                  data:
                    $ref: '#/components/schemas/ProductCategory'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Product category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Categories
      summary: Delete a product category
      description: Soft delete a product category by ID (Admin only). Cannot delete categories with associated products.
      operationId: deleteProductCategory
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the product category to delete
          required: true
          schema:
            type: string
            format: mongodb-id
      responses:
        '200':
          description: Product category deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product category deleted successfully
                  data:
                    type: string
        '400':
          description: Bad request (Invalid input or category has associated products)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Product category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/hashtags:
    post:
      tags:
        - Hashtags
      summary: Create a new hashtag
      description: Create a new hashtag with the provided details (Admin only)
      operationId: createHashtag
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateHashtagRequest'
      responses:
        '201':
          description: Hashtag created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Hashtag created successfully
                  data:
                    $ref: '#/components/schemas/Hashtag'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '409':
          description: Conflict - Hashtag with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Hashtags
      summary: Get all hashtags
      description: Retrieve a paginated list of all hashtags with filtering and sorting options
      operationId: getAllHashtags
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of hashtags per page
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          required: false
          schema:
            type: string
            enum: [name, created_at, updated_at, usage_count]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
        - name: search
          in: query
          description: Search term for filtering hashtags
          required: false
          schema:
            type: string
      responses:
        '200':
          description: List of hashtags retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Hashtags retrieved successfully
                  data:
                    type: object
                    properties:
                      hashtags:
                        type: array
                        items:
                          $ref: '#/components/schemas/Hashtag'
                      pagination:
                        $ref: '#/components/schemas/Pagination'
        '400':
          description: Bad request (Invalid query parameters)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/hashtags/search:
    get:
      tags:
        - Hashtags
      summary: Search hashtags
      description: Search hashtags based on provided query parameters
      operationId: searchHashtags
      parameters:
        - name: query
          in: query
          description: Search query for hashtag names
          required: true
          schema:
            type: string
            minLength: 2
        - name: limit
          in: query
          description: Maximum number of results to return
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
      responses:
        '200':
          description: Search results retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Search results retrieved successfully
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Hashtag'
        '400':
          description: Bad request (Invalid search query)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/hashtags/{id}:
    get:
      tags:
        - Hashtags
      summary: Get hashtag details
      description: Retrieve details of a specific hashtag by ID
      operationId: getHashtagDetails
      parameters:
        - name: id
          in: path
          description: ID of the hashtag to retrieve
          required: true
          schema:
            type: string
            format: mongodb-id
      responses:
        '200':
          description: Hashtag details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Hashtag details retrieved successfully
                  data:
                    $ref: '#/components/schemas/Hashtag'
        '404':
          description: Hashtag not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Hashtags
      summary: Update a hashtag
      description: Update an existing hashtag with new details (Admin only)
      operationId: updateHashtag
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the hashtag to update
          required: true
          schema:
            type: string
            format: mongodb-id
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateHashtagRequest'
      responses:
        '200':
          description: Hashtag updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Hashtag updated successfully
                  data:
                    $ref: '#/components/schemas/Hashtag'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Hashtag not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Hashtag with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Hashtags
      summary: Delete a hashtag
      description: Soft delete a hashtag by ID (Admin only)
      operationId: deleteHashtag
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          description: ID of the hashtag to delete
          required: true
          schema:
            type: string
            format: mongodb-id
      responses:
        '200':
          description: Hashtag deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Hashtag deleted successfully
                  data:
                    type: string
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Hashtag not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses:
    post:
      tags:
        - Courses
      summary: Create a new course
      description: Create a new course with basic information
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCourseRequest'
      responses:
        '201':
          description: Course created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CourseResponse'
        '400':
          description: Invalid request or course already in desired state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Hashtag with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Courses
      summary: Get all courses
      description: Retrieve a list of all available courses (public access)
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [created_at, updated_at, price, rating]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
        - name: category
          in: query
          description: Filter by category
          schema:
            type: string
        - name: search
          in: query
          description: Search term for course title or description
          schema:
            type: string
      responses:
        '200':
          description: List of courses retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Courses retrieved successfully"
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CoursePreviewResponse'
                  pagination:
                    $ref: '#/components/schemas/PaginationResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{id}:
    get:
      tags:
        - Courses
      summary: Update an existing course
      description: Update course information. Some fields cannot be updated if the course is approved.
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: ID of the course to update
      responses:
        '200':
          description: Course updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request or course already in desired state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Courses with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Courses
      summary: Update an existing course
      description: Update course information. Some fields cannot be updated if the course is approved.
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: ID of the course to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCourseRequest'
      responses:
        '200':
          description: Course updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request or course already in desired state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Courses with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{id}/status:
    patch:
      tags:
        - Courses
      summary: Toggle course active status
      description: Activate or deactivate a course
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
          description: ID of the course to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ToggleCourseStatusRequest'
      responses:
        '200':
          description: Course status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request or course already in desired state
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Course with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics:
    post:
      tags:
        - Topics
      summary: Create a new topic
      description: Create a new topic for a specific course
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course to add the topic to
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTopicRequest'
      responses:
        '201':
          description: Topic created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TopicResponse'
        '400':
          description: Invalid request data or invalid data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Courses with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics/{topicId}:
    put:
      tags:
        - Topics
      summary: Update an existing topic
      description: Update topic information within a course
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course containing the topic
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the topic to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTopicRequest'
      responses:
        '200':
          description: Topic updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request data or invalid data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Courses with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics/{topicId}/status:
    patch:
      tags:
        - Topics
      summary: Toggle topic active status
      description: Activate or deactivate a topic within a course
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course containing the topic
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the topic to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ToggleTopicStatusRequest'
      responses:
        '200':
          description: Topic status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request data or invalid data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Course with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics/{topicId}/lessons:
    post:
      tags:
        - Lessons
      summary: Create a new lesson
      description: Create a new lesson for a specific topic within a course
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course containing the topic
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the topic to add the lesson to
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLessonRequest'
      responses:
        '201':
          description: Lesson created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LessonResponse'
        '400':
          description: Invalid request data or invalid data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Course with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics/{topicId}/lessons/{lessonId}:
    put:
      tags:
        - Lessons
      summary: Update an existing lesson
      description: Update lesson information within a topic
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course containing the topic
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the topic containing the lesson
        - name: lessonId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the lesson to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateLessonRequest'
      responses:
        '200':
          description: Lesson updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request data or invalid data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Hashtag with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics/{topicId}/lessons/{lessonId}/upload-video:
    put:
      tags:
        - Lessons
      summary: Update lesson video
      description: Update or set the video URL for a lesson
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course containing the topic
        - name: topicId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the topic containing the lesson
        - name: lessonId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the lesson to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateLessonVideoRequest'
      responses:
        '200':
          description: Lesson video updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Invalid request data or invalid video URL
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Course is blacklisted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course, topic, or lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Conflict - Hashtag with the same name already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/coupons:
    post:
      tags:
        - Coupons
      summary: Create a new coupon for a course
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCouponRequest'
      responses:
        '201':
          description: Coupon created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Coupon not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Coupon code already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/coupons/{couponId}:
    put:
      tags:
        - Coupons
      summary: Update an existing coupon
      security:
        - BearerAuth: []
      parameters:
        - name: couponId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the coupon to update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCouponRequest'
      responses:
        '200':
          description: Product category updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Product category updated successfully
                  data:
                    example: ""
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Coupon not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: New coupon code already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    delete:
      tags:
        - Coupons
      summary: Delete a coupon
      security:
        - BearerAuth: []
      parameters:
        - name: couponId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the coupon to delete
      responses:
        '200':
          description: Coupon deleted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
                '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Coupon not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    get:
      tags:
        - Coupons
      summary: Get coupon details by ID
      security:
        - BearerAuth: []
      parameters:
        - name: couponId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the coupon
      responses:
        '200':
          description: Coupon details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CouponDetailResponse'
                '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Coupon not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/coupons:
    get:
      tags:
        - Coupons
      summary: Get all coupons with pagination
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: sort_by
          in: query
          schema:
            type: string
            default: created_at
        - name: sort_order
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: asc
      responses:
        '200':
          description: List of coupons retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'
                '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/coupons/search:
    get:
      tags:
        - Coupons
      summary: Search coupons
      security:
        - BearerAuth: []
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search term
        - name: search_by
          in: query
          schema:
            type: string
            enum: [code, discount_type]
            default: code
          description: Field to search in
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: sort_by
          in: query
          schema:
            type: string
            default: created_at
        - name: sort_order
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: asc
      responses:
        '200':
          description: Search results retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'
                '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/coupons/apply:
    post:
      tags:
        - Coupons
      summary: Apply a coupon code to a purchase
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplyCouponRequest'
      responses:
        '200':
          description: Coupon applied successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CouponResponse'
        '400':
          description: Invalid request data or coupon validation failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/banners:
    post:
      tags:
        - Banners
      summary: Create a new banner
      description: Creates a new banner (Admin only)
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - url
                - slug
                - description
                - link
              properties:
                url:
                  type: string
                  description: URL of the banner image
                  example: https://example.com/banner.jpg
                slug:
                  type: string
                  description: Unique identifier for the banner
                  example: summer-sale-2024
                description:
                  type: string
                  description: Description of the banner
                  example: Summer Sale 2024 Banner
                link:
                  type: string
                  description: URL where the banner redirects to
                  example: https://example.com/summer-sale
      responses:
        '201':
          description: Banner created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BannerResponse'
        '400':
          description: Invalid input data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Forbidden - Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Banners
      summary: Get all banners
      description: Retrieves a paginated list of all banners
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [created_at, updated_at, slug]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: List of banners retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BannerResponse'
                  pagination:
                    $ref: '#/components/schemas/PaginationResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/banners/search:
    get:
      tags:
        - Banners
      summary: Search banners
      description: Search banners with advanced filtering and pagination
      parameters:
        - name: search
          in: query
          description: Search term
          schema:
            type: string
        - name: search_by
          in: query
          description: Field to search in
          schema:
            type: string
            enum: [slug, description]
            default: description
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [created_at, updated_at, slug]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Search results retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/BannerResponse'
                  pagination:
                    $ref: '#/components/schemas/PaginationResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/banners/{id}:
    get:
      tags:
        - Banners
      summary: Get banner by ID
      description: Retrieves detailed information about a specific banner
      parameters:
        - name: id
          in: path
          required: true
          description: Banner ID
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Banner details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BannerResponse'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Banner not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: New banner already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    patch:
      tags:
        - Banners
      summary: Update banner
      description: Updates an existing banner (Admin only)
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Banner ID
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  description: URL of the banner image
                slug:
                  type: string
                  description: Unique identifier for the banner
                description:
                  type: string
                  description: Description of the banner
                link:
                  type: string
                  description: URL where the banner redirects to
      responses:
        '200':
          description: Banner updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BannerResponse'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Banner not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Banners
      summary: Delete banner
      description: Deletes a banner by ID (Admin only)
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Banner ID
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Banner deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Banner deleted successfully
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Banner not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/followers:
    post:
      tags:
        - Followers
      summary: Follow an instructor
      description: Allows a student to follow an instructor
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - teacher_id
              properties:
                teacher_id:
                  type: string
                  format: ObjectId
                  description: ID of the instructor to follow
                  example: "507f1f77bcf86cd799439011"
      responses:
        '201':
          description: Successfully followed the instructor
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Successfully followed the instructor"
                  data:
                    $ref: '#/components/schemas/FollowResponse'
        '400':
          description: Invalid input data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Student role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Instructor not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Already following this instructor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Followers
      summary: Unfollow an instructor
      description: Allows a student to unfollow an instructor
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - teacher_id
              properties:
                teacher_id:
                  type: string
                  format: ObjectId
                  description: ID of the instructor to unfollow
                  example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Successfully unfollowed the instructor
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Successfully unfollowed the instructor"
                  data:
                    $ref: '#/components/schemas/FollowResponse'
        '400':
          description: Invalid input data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Student role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Following relationship not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Already following this instructor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/cart:
    post:
      tags:
        - Cart
      summary: Add course to cart
      description: Add a course to the user's shopping cart
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - course_id
              properties:
                course_id:
                  type: string
                  format: ObjectId
                  description: ID of the course to add to cart
                  example: "507f1f77bcf86cd799439011"
                promotion_code:
                  type: string
                  description: Optional promotion code to apply
                  example: "SUMMER2024"
                source:
                  type: string
                  description: Source of the cart addition (e.g., 'web', 'mobile')
                  example: "web"
      responses:
        '201':
          description: Course successfully added to cart
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Course added to cart successfully"
                  data:
                    $ref: '#/components/schemas/CartResponse'

        '400':
          description: Invalid input data or course already in cart
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Student role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Cart
      summary: Get cart details
      description: Retrieve all items in the user's shopping cart
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Cart details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Cart details retrieved successfully"
                  data:
                    $ref: '#/components/schemas/CartDetailResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Student role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Cart
      summary: Clear cart
      description: Remove all courses from the user's shopping cart
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Cart cleared successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Cart cleared successfully"
                  data:
                    type: string
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/cart/courses/{courseId}:
    delete:
      tags:
        - Cart
      summary: Remove course from cart
      description: Remove a specific course from the user's shopping cart
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course to remove from cart
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Course removed from cart successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Course removed from cart successfully"
                  data:
                    $ref: '#/components/schemas/CartResponse'
        '400':
          description: Invalid course ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Student role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course not found in cart
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/preview:
    post:
      tags:
        - Previews
      summary: Create course preview
      description: Create a preview for a course (Instructor only)
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
                - description
                - video_url
              properties:
                title:
                  type: string
                  description: Title of the preview
                  example: "Introduction to Course"
                description:
                  type: string
                  description: Description of the preview
                  example: "Get a sneak peek of what you'll learn in this course"
                video_url:
                  type: string
                  description: URL of the preview video
                  example: "https://example.com/preview-video.mp4"
                thumbnail_url:
                  type: string
                  description: URL of the preview thumbnail
                  example: "https://example.com/preview-thumbnail.jpg"
                duration:
                  type: integer
                  description: Duration of the preview in seconds
                  example: 180
      responses:
        '201':
          description: Preview created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Preview created successfully"
                  data:
                    $ref: '#/components/schemas/PreviewResponse'
        '400':
          description: Invalid input data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - Authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Instructor role required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/instructors/followers:
    get:
      tags:
        - Instructors
      summary: Get instructor followers
      description: Get all followers of an instructor (requires instructor authentication)
      operationId: getInstructorFollowers
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
      responses:
        '200':
          description: Followers retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Followers retrieved successfully
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  pagination:
                    $ref: '#/components/schemas/PaginationResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an instructor)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/instructors:
    post:
      tags:
        - Instructors
      summary: Create a new instructor
      description: Create a new instructor account (requires admin privileges)
      operationId: createInstructor
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - full_name
                - email
                - password
                - verify
                - bio
                - phone_number
                - date_of_birth
                - country
              properties:
                full_name:
                  type: string
                  description: Instructor's full name
                  example: "John Doe"
                email:
                  type: string
                  format: email
                  description: Instructor's email address
                  example: instructor@example.com
                password:
                  type: string
                  format: password
                  example: StrongPassword123!
                  description: Instructor's password
                verify:
                  type: string
                  description: Instructor's verify profile
                  enum: ['Unverified', 'Verified', 'Banned']
                  example: Verified
                bio:
                  type: string
                  description: Instructor's biography
                  example: "Updated biography"
                phone_number:
                  type: string
                  description: Instructor's mobile phone
                  example: "0779232368"
                date_of_birth:
                  type: string
                  description: Instructor's date of birth
                  example: "1900-01-01"
                country:
                  type: string
                  description: Instructor's country
                  example: "VietNam"
      responses:
        '201':
          description: Instructor created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Instructor created successfully
                  data:
                    $ref: '#/components/schemas/Instructor'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '409':
          description: Conflict (Email already exists)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    get:
      tags:
        - Instructors
      summary: Get all instructors
      description: Get a paginated list of all instructors
      operationId: getAllInstructors
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [created_at, updated_at, full_name, email]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: List of instructors retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Instructors retrieved successfully
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Instructor'
                  pagination:
                    $ref: '#/components/schemas/PaginationResponse'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/instructors/search:
    get:
      tags:
        - Instructors
      summary: Search instructors
      description: Search instructors with advanced filtering and pagination (requires admin privileges)
      operationId: searchInstructors
      security:
        - BearerAuth: []
      parameters:
        - name: search
          in: query
          description: Search keyword
          schema:
            type: string
        - name: search_by
          in: query
          description: Field to search in
          schema:
            type: string
            enum: [full_name, email]
            default: full_name
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 100
        - name: sort_by
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [created_at, updated_at, full_name, email]
            default: created_at
        - name: sort_order
          in: query
          description: Sort order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Search results retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Search results retrieved successfully
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Instructor'
                  pagination:
                    $ref: '#/components/schemas/PaginationResponse'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/instructors/{id}:
    get:
      tags:
        - Instructors
      summary: Get instructor details
      description: Get detailed information about a specific instructor (requires admin privileges)
      operationId: getInstructorDetail
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Instructor ID
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Instructor details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Instructor details retrieved successfully
                  data:
                    $ref: '#/components/schemas/Instructor'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Instructor not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    patch:
      tags:
        - Instructors
      summary: Update instructor
      description: Update instructor information (requires admin privileges)
      operationId: updateInstructor
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Instructor ID
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  description: Instructor's full name
                  example: "John Doe"
                email:
                  type: string
                  format: email
                  description: Instructor's email address
                  example: instructor@example.com
                verify:
                  type: string
                  description: Instructor's verify profile
                  enum: ['Unverified', 'Verified', 'Banned']
                  example: Verified
                bio:
                  type: string
                  description: Instructor's biography
                  example: "Updated biography"
                phone_number:
                  type: string
                  description: Instructor's mobile phone
                  example: "0779232368"
                date_of_birth:
                  type: string
                  description: Instructor's date of birth
                  example: "1900-01-01"
                country:
                  type: string
                  description: Instructor's country
                  example: "VietNam"
      responses:
        '200':
          description: Instructor updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Instructor updated successfully
                  data:
                    $ref: '#/components/schemas/Instructor'
        '400':
          description: Bad request (Invalid input)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Instructor not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Instructors
      summary: Delete instructor
      description: Soft delete an instructor (requires admin privileges)
      operationId: deleteInstructor
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Instructor ID
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Instructor deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Instructor deleted successfully
                  data:
                    type: string
        '401':
          description: Unauthorized (Not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (Not an admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Instructor not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/students/{id}/upgrade:
    put:
      tags:
        - Students
      summary: Upgrade student to instructor
      description: Upgrade a student to instructor by assigning the instructor role (Admin only)
      operationId: upgradeStudentToInstructor
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Student ID to upgrade
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Student upgraded to instructor successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Student upgraded to instructor successfully
                  data:
                    $ref: '#/components/schemas/Instructor'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Student not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{id}/approve:
    put:
      tags:
        - Courses
      summary: Upgrade student to instructor
      description: Admin upgrades a student to instructor role for a specific course
      operationId: upgradeStudentToInstructor
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: Course ID
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Student upgraded to instructor successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Student upgraded to instructor successfully
                  data:
                    type: object
                    properties:
                      updated:
                        type: number
                        example: 1
                      studentId:
                        type: string
                        format: ObjectId
                        example: "507f1f77bcf86cd799439011"
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Student already has instructor role
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InternalServerErrorResponse'

  /v1/courses/search/title:
    get:
      tags:
        - Courses
      summary: Search courses by title
      description: |
        Search for courses by title keyword with case-insensitive partial matching.
        Returns a paginated list of courses that match the search criteria.
      operationId: searchCoursesByTitle
      parameters:
        - name: keyword
          in: query
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 100
          description: The keyword to search for in course titles
          example: "web development"
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
      responses:
        '200':
          description: Successfully retrieved matching courses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [success]
                    example: "success"
                  message:
                    type: string
                    example: "Courses retrieved successfully"
                  data:
                    type: object
                    properties:
                      courses:
                        type: array
                        items:
                          $ref: '#/components/schemas/CoursePreviewResponse'
                      pagination:
                        $ref: '#/components/schemas/Pagination'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/category/{categoryId}:
    get:
      tags:
        - Courses
      summary: Get courses by category
      description: |
        Retrieve all courses belonging to a specific category.
        Returns a list of courses with their preview information.
      operationId: getCoursesByCategory
      parameters:
        - name: categoryId
          in: path
          required: true
          schema:
            type: string
            format: objectId
          description: The ID of the category to filter courses by
          example: "507f1f77bcf86cd799439013"
      responses:
        '200':
          description: Successfully retrieved courses for the category
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [success]
                    example: "success"
                  message:
                    type: string
                    example: "Courses retrieved successfully"
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CoursePreviewResponse'
        '400':
          description: Invalid category ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Category not found
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/mylearning:
    get:
      tags:
        - Courses
      summary: Get enrolled courses
      description: |
        Retrieve a paginated list of courses that the current student is enrolled in.
        Requires authentication and student role.
      operationId: getMyCourses
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
      responses:
        '200':
          description: Successfully retrieved enrolled courses
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [success]
                    example: "success"
                  message:
                    type: string
                    example: "Enrolled courses retrieved successfully"
                  data:
                    type: object
                    properties:
                      courses:
                        type: array
                        items:
                          $ref: '#/components/schemas/CoursePreviewResponse'
                      pagination:
                        $ref: '#/components/schemas/Pagination'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/courses/{courseId}/topics/{topicId}/quizzes:
    post:
      tags:
        - Quizzes
      summary: Create quiz for a specific topic
      description: Instructor creates a quiz for a specific topic within a course
      operationId: createTopicQuiz
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course
          schema:
            type: string
            format: ObjectId
        - name: topicId
          in: path
          required: true
          description: ID of the topic
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - questions
              properties:
                questions:
                  type: array
                  items:
                    type: object
                    required:
                      - question
                      - options
                      - correct_answer
                    properties:
                      question:
                        type: string
                        description: The quiz question text
                      options:
                        type: array
                        items:
                          type: string
                        description: Array of possible answers
                      correct_answer:
                        type: string
                        description: The correct answer from options
                      explanation:
                        type: string
                        description: Optional explanation for the correct answer
      responses:
        '201':
          description: Quiz created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Quiz created successfully
                  data:
                    type: object
                    properties:
                      quiz_id:
                        type: string
                        format: ObjectId
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadRequest'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Forbidden'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/responses/NotFound'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/ServerError'

  /v1/courses/{courseId}/topics/{topicId}/lessons/{lessonId}/quizzes:
    post:
      tags:
        - Quizzes
      summary: Create quiz for a specific lesson
      description: Instructor creates a quiz for a specific lesson within a topic
      operationId: createLessonQuiz
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course
          schema:
            type: string
            format: ObjectId
        - name: topicId
          in: path
          required: true
          description: ID of the topic
          schema:
            type: string
            format: ObjectId
        - name: lessonId
          in: path
          required: true
          description: ID of the lesson
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuizQuestions'
      responses:
        '201':
          description: Quiz created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuizCreateResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadRequest'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Forbidden'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/responses/NotFound'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/ServerError'

  /v1/courses/{courseId}/quizzes:
    post:
      tags:
        - Quizzes
      summary: Create quiz for entire course
      description: Instructor creates a quiz for the entire course
      operationId: createCourseQuiz
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuizQuestions'
      responses:
        '201':
          description: Quiz created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuizCreateResponse'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadRequest'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Forbidden'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/responses/NotFound'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/ServerError'

  /v1/courses/{courseId}/quizzes/{quizId}:
    get:
      tags:
        - Quizzes
      summary: Get quiz for student
      description: Student fetches quiz content (without correct answers)
      operationId: getQuizForStudent
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course
          schema:
            type: string
            format: ObjectId
        - name: quizId
          in: path
          required: true
          description: ID of the quiz
          schema:
            type: string
            format: ObjectId
      responses:
        '200':
          description: Quiz data retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Quiz fetched successfully
                  data:
                    type: object
                    properties:
                      quiz_id:
                        type: string
                        format: ObjectId
                      questions:
                        type: array
                        items:
                          type: object
                          properties:
                            question_id:
                              type: string
                              format: ObjectId
                            question:
                              type: string
                            options:
                              type: array
                              items:
                                type: string
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Forbidden'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/responses/NotFound'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/ServerError'

  /v1/courses/{courseId}/quizzes/{quizId}/submit:
    post:
      tags:
        - Quizzes
      summary: Submit quiz answers
      description: Student submits their answers for a quiz
      operationId: submitQuiz
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          description: ID of the course
          schema:
            type: string
            format: ObjectId
        - name: quizId
          in: path
          required: true
          description: ID of the quiz
          schema:
            type: string
            format: ObjectId
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - answers
              properties:
                answers:
                  type: array
                  items:
                    type: object
                    required:
                      - question_id
                      - selected_option
                    properties:
                      question_id:
                        type: string
                        format: ObjectId
                        description: ID of the question
                      selected_option:
                        type: string
                        description: The selected answer option
      responses:
        '200':
          description: Quiz submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Quiz submitted successfully
                  data:
                    type: object
                    properties:
                      score:
                        type: number
                        format: float
                        description: Percentage score achieved
                      total_questions:
                        type: integer
                        description: Total number of questions
                      correct_answers:
                        type: integer
                        description: Number of correct answers
                      feedback:
                        type: array
                        items:
                          type: object
                          properties:
                            question_id:
                              type: string
                              format: ObjectId
                            is_correct:
                              type: boolean
                            explanation:
                              type: string
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/BadRequest'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Unauthorized'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/responses/Forbidden'
        '404':
          description: Course or student not found
          content:
            application/json:
              schema:
                $ref: '#/components/responses/NotFound'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/ServerError'

  /v1/wishlists:
    post:
      tags:
        - Wishlist
      summary: Add course to wishlist
      description: |
        Add a course to the authenticated student's wishlist.
        The course must be active and not already in the wishlist.
      operationId: addToWishlist
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - course_id
              properties:
                course_id:
                  type: string
                  format: objectId
                  description: The ID of the course to add to wishlist
                  example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Course successfully added to wishlist
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [success]
                    example: "success"
                  message:
                    type: string
                    example: "Course added to wishlist successfully"
                  data:
                    type: array
                    items:
                      type: object
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course not found or inactive
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '409':
          description: Course already in wishlist
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    get:
      tags:
        - Wishlist
      summary: Get wishlist courses
      description: |
        Retrieve a paginated list of courses in the authenticated student's wishlist.
        Results can be sorted by various fields.
      operationId: getWishlistCourses
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
            enum: [created_at, rating]
            default: created_at
          description: Field to sort by
        - name: sortOrder
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          description: Sort direction
      responses:
        '200':
          description: Successfully retrieved wishlist courses
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedWishlistResponse'
        '400':
          description: Invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description:  Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden (not admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/responses/ServerError'

  /v1/wishlists/courses/{courseId}:
    delete:
      tags:
        - Wishlist
      summary: Remove course from wishlist
      description: |
        Remove a course from the authenticated student's wishlist.
        The course must exist in the wishlist.
      operationId: removeFromWishlist
      security:
        - bearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: objectId
          description: The ID of the course to remove from wishlist
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Course successfully removed from wishlist
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [success]
                    example: "success"
                  message:
                    type: string
                    example: "Course removed from wishlist successfully"
                  data:
                    type: array
                    items:
                      type: object
        '400':
          description: Invalid course ID format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized (not authenticated)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/orders:
    get:
      tags:
        - Orders
      summary: Get student order history
      description: |
        Retrieve a paginated list of orders placed by the authenticated student.
        Results include order details, course information, and payment status.
      operationId: getStudentOrderHistory
      security:
        - BearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number for pagination
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
            enum: [created_at, amount]
            default: created_at
          description: Field to sort by
        - name: sortOrder
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          description: Sort direction
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [pending, completed, failed, refunded]
          description: Filter orders by status
      responses:
        '200':
          description: Successfully retrieved order history
          content:
            application/json:
              example:
                status: "success"
                message: "Order history retrieved successfully"
                data:
                  results:
                    - _id: "507f1f77bcf86cd799439011"
                      order_number: "ORD-2024-001"
                      course:
                        _id: "507f1f77bcf86cd799439012"
                        title: "Introduction to Web Development"
                        description: "Learn the basics of web development"
                        thumbnail: "https://example.com/thumbnails/web-dev.jpg"
                        price: 49.99
                        instructor:
                          _id: "507f1f77bcf86cd799439013"
                          name: "John Doe"
                          avatar: "https://example.com/avatars/john.jpg"
                      amount: 49.99
                      payment_method: "credit_card"
                      status: "completed"
                      created_at: "2024-03-15T08:30:00Z"
                      updated_at: "2024-03-15T08:30:00Z"
                  pagination:
                    page: 1
                    limit: 10
                    total: 48
        '400':
          description: Invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
              example:
                status: "error"
                message: "Invalid query parameters"
                errors:
                  - field: "page"
                    message: "Page number must be greater than 0"
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
              example:
                status: "error"
                message: "Authentication required"
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
              example:
                status: "error"
                message: "Access denied. Student role required"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: "error"
                message: "Internal server error"

  /v1/payments/create:
    post:
      tags:
        - Payments
      summary: Initialize MoMo payment
      description: |
        Initialize a MoMo payment for the courses in the user's cart.
        This endpoint will:
        1. Validate the cart contents
        2. Create an order record
        3. Initialize MoMo payment
        4. Process enrollments if payment is successful
        5. Clear the user's cart
      operationId: createPayment
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePaymentRequest'
            example:
              paymentMethod: "momo"
              couponId: "507f1f77bcf86cd799439011"
              discountAmount: 10.00
      responses:
        '201':
          description: Payment successfully initialized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentResponse'
              example:
                status: "success"
                message: "Payment initialized successfully"
                data:
                  payUrl: "https://test-payment.momo.vn/v2/gateway/test?payUrl=..."
                  orderId: "507f1f77bcf86cd799439011"
                  requestId: "1683123456789"
                  signature: "a1b2c3d4e5f6g7h8i9j0..."
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
              examples:
                invalidCart:
                  value:
                    status: "error"
                    message: "Cart is empty or invalid"
                invalidDiscount:
                  value:
                    status: "error"
                    message: "Invalid discount amount"
                momoError:
                  value:
                    status: "error"
                    message: "MoMo payment initialization failed: Invalid amount"
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
              example:
                status: "error"
                message: "Authentication required"
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
              example:
                status: "error"
                message: "Access denied. Student role required"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: "error"
                message: "Failed to process payment"

  /v1/course/feedbacks:
    post:
      tags:
        - Feedback
      summary: Submit feedback
      description: Submit general platform feedback or course-specific feedback
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackCreate'
      responses:
        '201':
          description: Feedback submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Feedback submitted successfully
                  data:
                    type: string
                    format: objectId
                    description: ID of the created feedback
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/course/{courseId}/feedbacks:
    post:
      tags:
        - Feedback
      summary: Submit course-specific feedback
      description: Submit feedback for a specific course (requires course completion)
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: objectId
          description: ID of the course
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FeedbackBase'
      responses:
        '201':
          description: Course feedback submitted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Course feedback submitted successfully
                  data:
                    type: string
                    format: objectId
                    description: ID of the created feedback
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Course not found or inactive
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/feedbacks:
    get:
      tags:
        - Feedback
      summary: Get all feedbacks
      description: Retrieve paginated list of feedbacks with optional course filter
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: query
          schema:
            type: string
            format: objectId
          description: Optional course ID to filter feedbacks
        - $ref: '#/components/schemas/PaginationParams'
      responses:
        '200':
          description: List of feedbacks retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackListResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - Admin access required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/feedbacks/{id}:
    get:
      tags:
        - Feedback
      summary: Get feedback details
      description: Retrieve detailed information about a specific feedback
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: objectId
          description: Feedback ID
      responses:
        '200':
          description: Feedback details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeedbackDetailResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Feedback not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Feedback
      summary: Delete feedback
      description: Soft delete a specific feedback
      security:
        - BearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: objectId
          description: Feedback ID to delete
      responses:
        '200':
          description: Feedback deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Feedback deleted successfully
                '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Feedback not found or inactive
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/comments/courses/{courseId}/lessons/{lessonId}:
    post:
      tags:
        - Comments
      summary: Create a comment on a lesson
      description: Create a new comment on a lesson within a course. Requires student role and course enrollment.
      security:
        - BearerAuth: []
      parameters:
        - name: courseId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the course
        - name: lessonId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the lesson
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CommentBase'
      responses:
        '201':
          description: Comment created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 201
                  message:
                    type: string
                    example: "Comment created successfully"
                  data:
                    $ref: '#/components/schemas/CommentResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/comments/lessons/{lessonId}:
    get:
      tags:
        - Comments
      summary: Get lesson comments
      description: Retrieve paginated and sorted comments for a lesson
      security:
        - BearerAuth: []
      parameters:
        - name: lessonId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the lesson
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
          description: Number of items per page
        - name: sortBy
          in: query
          schema:
            type: string
            enum: [created_at, rating]
            default: created_at
          description: Field to sort by
        - name: sortOrder
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          description: Sort order
      responses:
        '200':
          description: Comments retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "Comments retrieved successfully"
                  data:
                    $ref: '#/components/schemas/PaginatedCommentsResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /v1/comments/{commentId}:
    delete:
      tags:
        - Comments
      summary: Delete a comment
      description: Delete a comment by the logged-in student
      security:
        - BearerAuth: []
      parameters:
        - name: commentId
          in: path
          required: true
          schema:
            type: string
            format: string
          description: ID of the comment to delete
      responses:
        '200':
          description: Comment deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: integer
                    example: 200
                  message:
                    type: string
                    example: "Comment deleted successfully"
                  data:
                    type: array
                    items: {}
                    example: []
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BadRequestResponse'
        '401':
          description: Unauthorized - User not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UnauthorizedResponse'
        '403':
          description: Forbidden - User is not a student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ForbiddenResponse'
        '404':
          description: Lesson not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 500
        message:
          example: Internal server error
        data:
          example: ''
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    BadRequestResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 400
        message:
          example: Bad request (e.g., missing data or invalid data)
        data:
          example: ''
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    ForbiddenResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 403
        message:
          example: Forbidden. The client is authenticated but does not have the required permissions.
        data:
          example: ''
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    UnauthorizedResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 401
        message:
          example: You do not have permission to perform this task. Please login again!
        data:
          example: ''
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    NotFoundResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 404
        message:
          example: Not found
        data:
          example: ''
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    ConflictResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 409
        message:
          example: Conflict data
        data:
          example: ''
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    ValidationErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: Validation failed
        errors:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
                example: email
              message:
                type: string
                example: Invalid email format

    UserProfile:
      type: object
      properties:
        _id:
          type: string
          example: 5f7c8f5e6d0e8a1a2c3d4e5f
        username:
          type: string
          example: johndoe
        full_name:
          type: string
          example: John Doe
        email:
          type: string
          format: email
          example: john.doe@example.com
        bio:
          type: string
          example: Web developer and instructor
        avatar:
          type: string
          example: https://example.com/avatars/johndoe.jpg
        cover_photo:
          type: string
          example: https://example.com/covers/johndoe.jpg
        gender:
          type: string
          enum: [Male, Female, Other]
          example: Male
        date_of_birth:
          type: string
          format: date
          example: 1990-01-01
        phone_number:
          type: string
          example: +84123456789
        verify:
          type: string
          enum: [Unverified, Verified, Celerity, Banned]
          example: Verified
        experience:
          type: string
          example: 5+ years in web development
        language:
          type: string
          example: en
        country:
          type: string
          example: Vietnam
        timezone:
          type: string
          example: Asia/Ho_Chi_Minh
        social_links:
          type: object
          properties:
            website:
              type: string
              example: https://johndoe.com
            linkedin:
              type: string
              example: https://linkedin.com/in/johndoe
            facebook:
              type: string
              example: https://facebook.com/johndoe
        interests:
          type: array
          items:
            type: string
          example: ['programming', 'web development', 'teaching']
        created_at:
          type: string
          format: date-time
          example: 2023-01-01T00:00:00Z
        updated_at:
          type: string
          format: date-time
          example: 2023-01-15T00:00:00Z

    UpdateUserProfileRequest:
      type: object
      properties:
        full_name:
          type: string
          example: John Doe
          description: User's full name
        bio:
          type: string
          example: I am a software developer with expertise in full-stack development
          description: User's biography
        avatar:
          type: string
          format: uri
          example: https://example.com/avatars/johndoe.jpg
          description: URL to user's avatar image
        cover_photo:
          type: string
          format: uri
          example: https://example.com/covers/johndoe-cover.jpg
          description: URL to user's cover photo
        gender:
          type: string
          enum: [Male, Female, Other]
          example: Male
          description: User's gender
        date_of_birth:
          type: string
          format: date
          example: 1990-01-01
          description: User's date of birth in ISO-8601 format
        phone_number:
          type: string
          example: +84123456789
          description: User's phone number
        experience:
          type: string
          example: 5+ years in web development
          description: User's professional experience
        language:
          type: string
          example: en
          description: User's preferred language
        country:
          type: string
          example: Vietnam
          description: User's country
        timezone:
          type: string
          example: Asia/Ho_Chi_Minh
          description: User's timezone
        social_links:
          type: object
          properties:
            website:
              type: string
              format: uri
              example: https://johndoe.com
            linkedin:
              type: string
              format: uri
              example: https://linkedin.com/in/johndoe
            facebook:
              type: string
              format: uri
              example: https://facebook.com/johndoe
            instagram:
              type: string
              format: uri
              example: https://instagram.com/johndoe
            tiktok:
              type: string
              format: uri
              example: https://tiktok.com/@johndoe
            x:
              type: string
              format: uri
              example: https://x.com/johndoe
            youtube:
              type: string
              format: uri
              example: https://youtube.com/c/johndoe
          description: User's social media links
        interests:
          type: array
          items:
            type: string
          example: ['programming', 'web development', 'teaching']
          description: User's interests

    UserListItem:
      type: object
      properties:
        _id:
          type: string
          example: '5f7c8f5e6d0e8a1a2c3d4e5f'
          description: User ID
        username:
          type: string
          example: 'john_doe'
          description: User's username
        full_name:
          type: string
          example: 'John Doe'
          description: User's full name
        email:
          type: string
          format: email
          example: 'john.doe@example.com'
          description: User's email address
        avatar:
          type: string
          format: uri
          example: 'https://example.com/avatars/johndoe.jpg'
          description: URL to user's avatar image
        verify:
          type: integer
          enum: [0, 1, 2]
          example: 1
          description: 'User verification status: 0 - Unverified, 1 - Verified, 2 - Banned'
        is_pro:
          type: boolean
          example: false
          description: Indicates if user has pro status
        roles:
          type: array
          items:
            type: string
          example: ['Student', 'Teacher']
          description: List of user's role names
        created_at:
          type: string
          format: date-time
          example: '2023-01-15T08:30:00Z'
          description: User creation timestamp
        last_login:
          type: string
          format: date-time
          example: '2023-03-20T14:25:30Z'
          description: Last login timestamp

    Role:
      type: object
      properties:
        _id:
          type: string
          example: '60d0fe4f5311236168a109cb'
          description: Role ID
        name:
          type: string
          example: 'INSTRUCTOR'
          description: Role name (unique identifier)
        description:
          type: string
          example: 'Can create and manage courses'
          description: Role description
        is_default:
          type: boolean
          example: false
          description: Whether this is a default role assigned to new users
        is_system:
          type: boolean
          example: false
          description: Whether this is a protected system role that cannot be modified or deleted
        permissions:
          type: array
          items:
            type: string
          example: ['create:course', 'edit:course', 'delete:course']
          description: List of permission keys assigned to this role
        created_at:
          type: string
          format: date-time
          example: '2023-01-15T08:30:00Z'
          description: Role creation timestamp
        updated_at:
          type: string
          format: date-time
          example: '2023-03-20T14:25:30Z'
          description: Role last update timestamp

    Permission:
      type: object
      properties:
        _id:
          type: string
          example: '60d0fe4f5311236168a109cd'
          description: Permission ID
        key:
          type: string
          example: 'create:course'
          description: Permission key (unique identifier)
        name:
          type: string
          example: 'Create Course'
          description: Human-readable permission name
        description:
          type: string
          example: 'Allows creating new courses'
          description: Permission description
        group:
          type: string
          example: 'Courses'
          description: Permission group for categorization
        is_system:
          type: boolean
          example: true
          description: Whether this is a system-defined permission (cannot be deleted)
        created_at:
          type: string
          format: date-time
          example: '2023-01-15T08:30:00Z'
          description: Permission creation timestamp

    SuccessResponse:
      type: object
      properties:
        statusCode:
          type: integer
          example: 200
        message:
          example: Success
        data:
          example: ""
        dateTime:
          type: string
          format: date-time
          example: '2025-05-22T00:00:00.000Z'

    Category:
      type: object
      properties:
        _id:
          type: string
          format: mongodb-id
          example: 5f7c8f5e6d0e8a1a2c3d4e5f
        name:
          type: string
          example: 'Web Development'
        slug:
          type: string
          example: 'web-development'
        description:
          type: string
          example: 'Courses related to web development technologies'
        icon_url:
          type: string
          format: uri
          example: 'https://example.com/icons/webdev.png'
        thumbnail:
          type: string
          format: uri
          example: 'https://example.com/thumbnails/webdev.jpg'
        parent_id:
          type: string
          format: mongodb-id
          nullable: true
          example: ""
        is_removed:
          type: boolean
          example: false
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateCategoryRequest:
      type: object
      required:
        - name
        - slug
      properties:
        name:
          type: string
          example: 'Web Development'
        slug:
          type: string
          example: 'web-development'
        description:
          type: string
          example: 'Courses related to web development technologies'
        icon_url:
          type: string
          format: uri
          example: 'https://example.com/icons/webdev.png'
        thumbnail:
          type: string
          format: uri
          example: 'https://example.com/thumbnails/webdev.jpg'
        parent_id:
          type: string
          format: mongodb-id
          nullable: true
          example: ""

    UpdateCategoryRequest:
      type: object
      properties:
        name:
          type: string
          example: 'Frontend Web Development'
        slug:
          type: string
          example: 'frontend-web-development'
        description:
          type: string
          example: 'Courses focused on frontend web development technologies'
        icon_url:
          type: string
          format: uri
          example: 'https://example.com/icons/frontend.png'
        thumbnail:
          type: string
          format: uri
          example: 'https://example.com/thumbnails/frontend.jpg'
        parent_id:
          type: string
          format: mongodb-id
          nullable: true
          example: '5f7c8f5e6d0e8a1a2c3d4e5f'

    Pagination:
      type: object
      properties:
        total:
          type: integer
          example: 125
        page:
          type: integer
          example: 1
        limit:
          type: integer
          example: 10
        total_pages:
          type: integer
          example: 13

    Topic:
      type: object
      properties:
        _id:
          type: string
          format: mongodb-id
          example: '60d0fe4f5311236168a109ca'
          description: Topic ID
        course_id:
          type: string
          format: mongodb-id
          example: '60d0fe4f5311236168a109cb'
          description: ID of the course this topic belongs to
        title:
          type: string
          example: 'Introduction to JavaScript'
          description: Topic title
        description:
          type: string
          example: 'Learn the basics of JavaScript programming language'
          description: Topic description (optional)
        topic_order:
          type: integer
          example: 1
          description: Sequence order of the topic within the course
        is_active:
          type: boolean
          example: true
          description: Whether the topic is visible to students
        created_by_id:
          type: string
          format: mongodb-id
          example: '60d0fe4f5311236168a109cc'
          description: ID of the instructor who created the topic
        is_removed:
          type: boolean
          example: false
          description: Whether the topic has been soft-deleted
        created_at:
          type: string
          format: date-time
          example: '2023-05-15T08:30:00Z'
          description: Topic creation timestamp
        updated_at:
          type: string
          format: date-time
          example: '2023-05-16T10:25:30Z'
          description: Topic last update timestamp

    Lesson:
      type: object
      properties:
        _id:
          type: string
          format: mongodb-id
          example: '60d0fe4f5311236168a109cd'
          description: Lesson ID
        topic_id:
          type: string
          format: mongodb-id
          example: '60d0fe4f5311236168a109ca'
          description: ID of the topic this lesson belongs to
        title:
          type: string
          example: 'Variables and Data Types'
          description: Lesson title
        video_url:
          type: string
          format: uri
          example: 'https://example.com/videos/javascript-variables.mp4'
          description: URL to the lesson video (optional)
        document_url:
          type: string
          format: uri
          example: 'https://example.com/documents/javascript-variables.pdf'
          description: URL to lesson documents (optional)
        duration:
          type: number
          example: 15
          description: Lesson duration in minutes (optional)
        lesson_order:
          type: integer
          example: 1
          description: Sequence order of the lesson within the topic
        created_by_id:
          type: string
          format: mongodb-id
          example: '60d0fe4f5311236168a109cc'
          description: ID of the instructor who created the lesson
        is_removed:
          type: boolean
          example: false
          description: Whether the lesson has been soft-deleted
        created_at:
          type: string
          format: date-time
          example: '2023-05-15T08:30:00Z'
          description: Lesson creation timestamp
        updated_at:
          type: string
          format: date-time
          example: '2023-05-16T10:25:30Z'
          description: Lesson last update timestamp

    ProductCategory:
      type: object
      properties:
        _id:
          type: string
          format: mongodb-id
          example: 5f7c8f5e6d0e8a1a2c3d4e5f
        name:
          type: string
          example: 'Electronics'
        slug:
          type: string
          example: 'electronics'
        description:
          type: string
          example: 'Electronic devices and accessories'
        icon_url:
          type: string
          format: uri
          example: 'https://example.com/icons/electronics.png'
        thumbnail:
          type: string
          format: uri
          example: 'https://example.com/thumbnails/electronics.jpg'
        parent_id:
          type: string
          format: mongodb-id
          nullable: true
          example: ""
        is_removed:
          type: boolean
          example: false
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    CreateProductCategoryRequest:
      type: object
      required:
        - name
        - slug
      properties:
        name:
          type: string
          example: 'Electronics'
          minLength: 2
          maxLength: 100
        slug:
          type: string
          example: 'electronics'
          pattern: '^[a-z0-9]+(?:-[a-z0-9]+)*$'
        description:
          type: string
          example: 'Electronic devices and accessories'
          maxLength: 500
        icon_url:
          type: string
          format: uri
          example: 'https://example.com/icons/electronics.png'
        thumbnail:
          type: string
          format: uri
          example: 'https://example.com/thumbnails/electronics.jpg'
        parent_id:
          type: string
          format: mongodb-id
          nullable: true
          example: ""

    UpdateProductCategoryRequest:
      type: object
      properties:
        name:
          type: string
          example: 'Consumer Electronics'
          minLength: 2
          maxLength: 100
        slug:
          type: string
          example: 'consumer-electronics'
          pattern: '^[a-z0-9]+(?:-[a-z0-9]+)*$'
        description:
          type: string
          example: 'Consumer electronic devices and accessories'
          maxLength: 500
        icon_url:
          type: string
          format: uri
          example: 'https://example.com/icons/consumer-electronics.png'
        thumbnail:
          type: string
          format: uri
          example: 'https://example.com/thumbnails/consumer-electronics.jpg'
        parent_id:
          type: string
          format: mongodb-id
          nullable: true
          example: '5f7c8f5e6d0e8a1a2c3d4e5f'

    Hashtag:
      type: object
      properties:
        _id:
          type: string
          format: mongodb-id
          example: 5f7c8f5e6d0e8a1a2c3d4e5f
        name:
          type: string
          example: 'javascript'
          description: Hashtag name (without # symbol)
        slug:
          type: string
          example: 'javascript'
          description: URL-friendly version of the hashtag name
        description:
          type: string
          example: 'JavaScript programming language related content'
          description: Optional description of the hashtag
        usage_count:
          type: integer
          example: 150
          description: Number of times this hashtag has been used
        is_removed:
          type: boolean
          example: false
          description: Whether the hashtag has been soft-deleted
        created_at:
          type: string
          format: date-time
          example: '2023-01-15T08:30:00Z'
        updated_at:
          type: string
          format: date-time
          example: '2023-03-20T14:25:30Z'

    CreateHashtagRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: 'javascript'
          description: Hashtag name (without # symbol)
          minLength: 2
          maxLength: 50
          pattern: '^[a-zA-Z0-9]+(?:[_-][a-zA-Z0-9]+)*$'
        description:
          type: string
          example: 'JavaScript programming language related content'
          description: Optional description of the hashtag
          maxLength: 500

    UpdateHashtagRequest:
      type: object
      properties:
        name:
          type: string
          example: 'javascript-programming'
          description: Updated hashtag name (without # symbol)
          minLength: 2
          maxLength: 50
          pattern: '^[a-zA-Z0-9]+(?:[_-][a-zA-Z0-9]+)*$'
        description:
          type: string
          example: 'Content related to JavaScript programming language and ecosystem'
          description: Updated description of the hashtag
          maxLength: 500

    CreateCourseRequest:
      type: object
      required:
        - title
        - description
        - price
        - category
      properties:
        title:
          type: string
          description: Course title
          minLength: 3
          maxLength: 200
          example: "Introduction to Web Development"
        description:
          type: string
          description: Course description
          minLength: 10
          maxLength: 2000
          example: "Learn the fundamentals of web development including HTML, CSS, and JavaScript"
        price:
          type: number
          description: Course price (0 for free courses)
          minimum: 0
          example: 49.99
        category:
          type: string
          description: Category ID
          format: string
          example: "507f1f77bcf86cd799439011"
        level:
          type: string
          enum: [Beginner, Intermediate, Advanced, AllLevels]
          description: Course difficulty level
          default: AllLevels
          example: "Beginner"

    UpdateCourseRequest:
      type: object
      properties:
        title:
          type: string
          description: Course title
          minLength: 3
          maxLength: 200
          example: "Advanced Web Development"
        description:
          type: string
          description: Course description
          minLength: 10
          maxLength: 2000
          example: "Advanced web development concepts and best practices"
        price:
          type: number
          description: Course price
          minimum: 0
          example: 79.99
        lessons:
          type: array
          items:
            type: string
          example: ["507f1f77bcf86cd799439011","507f1f77bcf86cd799439123"]
          description: List of lessons
        level:
          type: string
          enum: [Beginner, Intermediate, Advanced, AllLevels]
          description: Course difficulty level
          example: "Intermediate"
        thumbnail:
          type: string
          description: Thumbnail url
          example: "http://res.cloudinary.com/dpbm00eke/image/upload/v1720197825/avatar/iwdsqojke1mxj0bla6r2.com"

    ToggleCourseStatusRequest:
      type: object
      required:
        - is_active
      properties:
        is_active:
          type: boolean
          description: New active status for the course
          example: true

    CourseResponse:
      type: object
      properties:
        course_id:
          type: string
          format: string
          description: Unique identifier of the created course
          example: "507f1f77bcf86cd799439011"
        slug:
          type: string
          description: URL-friendly version of the course title
          example: "introduction-to-web-development"

    CreateTopicRequest:
      type: object
      required:
        - title
        - description
      properties:
        title:
          type: string
          description: Topic title
          minLength: 3
          maxLength: 200
          example: "Introduction to HTML"
        description:
          type: string
          description: Topic description
          minLength: 10
          maxLength: 2000
          example: "Learn the basics of HTML including tags, elements, and document structure"

    UpdateTopicRequest:
      type: object
      properties:
        title:
          type: string
          description: Topic title
          minLength: 3
          maxLength: 200
          example: "Advanced HTML Concepts"
        description:
          type: string
          description: Topic description
          minLength: 10
          maxLength: 2000
          example: "Advanced HTML concepts including semantic elements and accessibility"

    ToggleTopicStatusRequest:
      type: object
      required:
        - is_active
      properties:
        is_active:
          type: boolean
          description: New active status for the topic
          example: true

    TopicResponse:
      type: object
      properties:
        topic_id:
          type: string
          format: string
          description: Unique identifier of the created topic
          example: "507f1f77bcf86cd799439011"

    CreateLessonRequest:
      type: object
      required:
        - title
        - duration
      properties:
        title:
          type: string
          description: Lesson title
          minLength: 3
          maxLength: 200
          example: "Introduction to HTML Elements"
        duration:
          type: integer
          description: Lesson duration in minutes
          minimum: 1
          maximum: 480
          example: 45

    UpdateLessonRequest:
      type: object
      properties:
        title:
          type: string
          description: Lesson title
          minLength: 3
          maxLength: 200
          example: "Advanced HTML Elements and Attributes"
        duration:
          type: integer
          description: Lesson duration in minutes
          minimum: 1
          maximum: 480
          example: 60

    UpdateLessonVideoRequest:
      type: object
      required:
        - video_url
      properties:
        video_url:
          type: string
          description: URL of the lesson video
          format: uri
          example: "https://example.com/videos/lesson-1.mp4"

    LessonResponse:
      type: object
      properties:
        lesson_id:
          type: string
          format: string
          description: Unique identifier of the created lesson
          example: "507f1f77bcf86cd799439011"

    CouponType:
      type: object
      properties:
        code:
          type: string
          description: Unique coupon code
          minLength: 3
          maxLength: 20
          pattern: '^[A-Z0-9]+$'
        discount_amount:
          type: number
          description: Discount amount
          minimum: 0
        discount_type:
          type: string
          enum: [percentage, fixed]
          description: Type of discount (percentage or fixed amount)
        min_purchase:
          type: number
          description: Minimum purchase amount required
          minimum: 0
        max_usage:
          type: integer
          description: Maximum number of times the coupon can be used
          minimum: 1
        expiration_date:
          type: string
          format: date-time
          description: Coupon expiration date and time
      required:
        - discount_amount
        - discount_type
        - expiration_date

    CreateCouponRequest:
      allOf:
        - $ref: '#/components/schemas/CouponType'
        - type: object
          properties:
            code:
              type: string
              description: Optional coupon code. If not provided, a unique code will be generated
              nullable: true

    UpdateCouponRequest:
      type: object
      properties:
        code:
          type: string
          description: New coupon code
          minLength: 3
          maxLength: 20
          pattern: '^[A-Z0-9]+$'
          nullable: true
        discount_amount:
          type: number
          description: New discount amount
          minimum: 0
          nullable: true
        discount_type:
          type: string
          enum: [percentage, fixed]
          description: New discount type
          nullable: true
        min_purchase:
          type: number
          description: New minimum purchase amount
          minimum: 0
          nullable: true
        max_usage:
          type: integer
          description: New maximum usage limit
          minimum: 1
          nullable: true
        expiration_date:
          type: string
          format: date-time
          description: New expiration date
          nullable: true

    CouponResponse:
      type: object
      properties:
        _id:
          type: string
          format: string
          description: Coupon ID
        code:
          type: string
        discount_amount:
          type: number
        discount_type:
          type: string
          enum: [percentage, fixed]
        min_purchase:
          type: number
        max_usage:
          type: integer
        usage_count:
          type: integer
          description: Number of times the coupon has been used
        expiration_date:
          type: string
          format: date-time
        created_by_id:
          type: string
          format: string
        updated_by_id:
          type: string
          format: string
          nullable: true
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
          nullable: true

    CouponDetailResponse:
      type: object
      properties:
        coupon:
          $ref: '#/components/schemas/CouponResponse'
        total_courses:
          type: integer
          description: Total number of courses using this coupon

    PaginationQuery:
      type: object
      properties:
        page:
          type: integer
          description: Page number
          minimum: 1
          default: 1
        limit:
          type: integer
          description: Number of items per page
          minimum: 1
          maximum: 100
          default: 10
        sort_by:
          type: string
          description: Field to sort by
          default: created_at
        sort_order:
          type: string
          enum: [asc, desc]
          description: Sort order
          default: asc

    SearchCouponQuery:
      allOf:
        - $ref: '#/components/schemas/PaginationQuery'
        - type: object
          properties:
            search:
              type: string
              description: Search term
              nullable: true
            search_by:
              type: string
              enum: [code, discount_type]
              description: Field to search in
              default: code

    PaginatedResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/CouponResponse'
        metadata:
          type: object
          properties:
            total:
              type: integer
              description: Total number of items
            page:
              type: integer
              description: Current page number
            limit:
              type: integer
              description: Items per page
            pages:
              type: integer
              description: Total number of pages

    ApplyCouponRequest:
      type: object
      properties:
        code:
          type: string
          description: Coupon code to apply
        total_price:
          type: number
          description: Total price of the purchase
          minimum: 0
      required:
        - code
        - total_price

    CourseBase:
      type: object
      properties:
        title:
          type: string
          description: Course title
          minLength: 3
          maxLength: 200
          example: "Advanced Web Development"
        description:
          type: string
          description: Course description
          minLength: 10
          maxLength: 2000
          example: "Learn advanced web development concepts and best practices"
        price:
          type: number
          description: Course price in USD
          minimum: 0
          maximum: 9999.99
          example: 79.99
        category_id:
          type: string
          format: string
          description: Reference to the course category
          example: "507f1f77bcf86cd799439011"
        level:
          type: string
          enum: [Beginner, Intermediate, Advanced, AllLevels]
          description: Course difficulty level
          example: "Intermediate"
        thumbnail_url:
          type: string
          format: uri
          description: URL to the course thumbnail image
          example: "https://example.com/course-thumbnail.jpg"
        is_active:
          type: boolean
          description: Course active status
          default: true
          example: true

    CreateCourseRequest:
      allOf:
        - $ref: '#/components/schemas/CourseBase'
        - type: object
          required:
            - title
            - description
            - price
            - category_id
            - level
          properties:
            tags:
              type: array
              description: Course tags for better discoverability
              items:
                type: string
                minLength: 2
                maxLength: 30
              example: ["web-development", "javascript", "react"]

    UpdateCourseRequest:
      allOf:
        - $ref: '#/components/schemas/CourseBase'
        - type: object
          properties:
            tags:
              type: array
              description: Updated course tags
              items:
                type: string
                minLength: 2
                maxLength: 30
              example: ["web-development", "javascript", "react", "typescript"]

    CourseResponse:
      type: object
      properties:
        id:
          type: string
          format: string
          description: Unique identifier of the course
          example: "507f1f77bcf86cd799439011"
        slug:
          type: string
          description: URL-friendly version of the course title
          example: "advanced-web-development"
        created_at:
          type: string
          format: date-time
          description: Course creation timestamp
          example: "2024-03-20T10:30:00Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-03-20T15:45:00Z"
        instructor:
          $ref: '#/components/schemas/UserReference'
        category:
          $ref: '#/components/schemas/CategoryReference'
        stats:
          type: object
          properties:
            total_students:
              type: integer
              minimum: 0
              description: Total number of enrolled students
              example: 150
            average_rating:
              type: number
              minimum: 0
              maximum: 5
              description: Average course rating
              example: 4.5
            total_reviews:
              type: integer
              minimum: 0
              description: Total number of reviews
              example: 45
        $ref: '#/components/schemas/CourseBase'

    ToggleCourseStatusRequest:
      type: object
      required:
        - is_active
      properties:
        is_active:
          type: boolean
          description: New active status for the course
          example: true
        reason:
          type: string
          description: Optional reason for status change
          maxLength: 500
          example: "Course content needs revision"

    FollowResponse:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Unique identifier of the following relationship
        student_id:
          type: string
          format: ObjectId
          description: ID of the student who is following
        teacher_id:
          type: string
          format: ObjectId
          description: ID of the instructor being followed
        created_at:
          type: string
          format: date-time
          description: Timestamp when the following relationship was created
        updated_at:
          type: string
          format: date-time
          description: Timestamp when the following relationship was last updated

    CartResponse:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Unique identifier of the cart item
        user_id:
          type: string
          format: ObjectId
          description: ID of the user who owns the cart
        course_id:
          type: string
          format: ObjectId
          description: ID of the course in cart
        promotion_code:
          type: string
          description: Applied promotion code (if any)
        source:
          type: string
          description: Source of the cart addition
        created_at:
          type: string
          format: date-time
          description: Timestamp when the item was added to cart
        updated_at:
          type: string
          format: date-time
          description: Timestamp when the cart item was last updated

    CartDetailResponse:
      type: object
      properties:
        items:
          type: array
          description: List of courses in the cart
          items:
            type: object
            properties:
              course:
                $ref: '#/components/schemas/CourseSummary'
              promotion_code:
                type: string
                description: Applied promotion code (if any)
              source:
                type: string
                description: Source of the cart addition
              added_at:
                type: string
                format: date-time
                description: When the course was added to cart
        total_items:
          type: integer
          description: Total number of items in cart
        total_price:
          type: number
          format: float
          description: Total price of all items in cart
        discounted_price:
          type: number
          format: float
          description: Total price after applying promotions

    CourseSummary:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Course ID
        title:
          type: string
          description: Course title
        price:
          type: number
          format: float
          description: Course price
        thumbnail:
          type: string
          description: Course thumbnail URL
        instructor:
          type: object
          properties:
            _id:
              type: string
              format: ObjectId
              description: Instructor ID
            name:
              type: string
              description: Instructor name

    CoursePreviewResponse:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Course ID
        title:
          type: string
          description: Course title
        slug:
          type: string
          description: URL-friendly course identifier
        description:
          type: string
          description: Course description
        thumbnail:
          type: string
          description: Course thumbnail URL
        price:
          type: number
          format: float
          description: Course price
        rating:
          type: number
          format: float
          description: Course average rating
        total_students:
          type: integer
          description: Total number of enrolled students
        instructor:
          type: object
          properties:
            _id:
              type: string
              format: ObjectId
              description: Instructor ID
            name:
              type: string
              description: Instructor name
            avatar:
              type: string
              description: Instructor avatar URL
        category:
          type: object
          properties:
            _id:
              type: string
              format: ObjectId
              description: Category ID
            name:
              type: string
              description: Category name
        is_active:
          type: boolean
          description: Whether the course is active
        created_at:
          type: string
          format: date-time
          description: Course creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Course last update timestamp

    PreviewResponse:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Preview ID
        course_id:
          type: string
          format: ObjectId
          description: ID of the associated course
        title:
          type: string
          description: Preview title
        description:
          type: string
          description: Preview description
        video_url:
          type: string
          description: URL of the preview video
        thumbnail_url:
          type: string
          description: URL of the preview thumbnail
        duration:
          type: integer
          description: Duration of the preview in seconds
        created_by:
          type: string
          format: ObjectId
          description: ID of the instructor who created the preview
        created_at:
          type: string
          format: date-time
          description: Preview creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Preview last update timestamp

    PaginationResponse:
      type: object
      properties:
        total:
          type: integer
          description: Total number of items
        page:
          type: integer
          description: Current page number
        limit:
          type: integer
          description: Number of items per page
        total_pages:
          type: integer
          description: Total number of pages

    Instructor:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Instructor ID
        email:
          type: string
          format: email
          description: Instructor's email address
        full_name:
          type: string
          description: Instructor's full name
        bio:
          type: string
          description: Instructor's biography
        avatar:
          type: string
          description: URL to instructor's avatar image
        is_active:
          type: boolean
          description: Instructor's active status
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
        deleted_at:
          type: string
          format: date-time
          nullable: true
          description: Soft deletion timestamp

    CreatePaymentRequest:
      type: object
      required:
        - paymentMethod
        - status
        - totalAmount
      properties:
        paymentMethod:
          type: string
          enum: [momo]
          default: momo
          description: Payment method to use (currently only MoMo is supported)
          example: "momo"
        couponId:
          type: string
          format: objectId
          description: Optional coupon ID to apply discount
          example: "507f1f77bcf86cd799439011"
        status:
          type: string
          enum: [CreditCard, Cash, MoMo, BankTransfer, PayPal, Other]
          default: CreditCard
          description: Payment status to use (currently only CreditCard is supported)
          example: "CreditCard"
        discountAmount:
          type: number
          format: float
          minimum: 0
          description: Optional discount amount to apply
          example: 10.00
        totalAmount:
          type: number
          format: float
          minimum: 0
          description: Optional total amount
          example: 100000.00

    PaymentResponse:
      type: object
      properties:
        status:
          type: string
          enum: [success]
          example: "success"
        message:
          type: string
          example: "Payment initialized successfully"
        data:
          type: object
          properties:
            payUrl:
              type: string
              format: uri
              description: MoMo payment URL to redirect user
              example: "https://test-payment.momo.vn/v2/gateway/test?payUrl=..."
            orderId:
              type: string
              format: objectId
              description: Generated order ID for tracking
              example: "507f1f77bcf86cd799439011"
            requestId:
              type: string
              description: MoMo request ID
              example: "1683123456789"
            signature:
              type: string
              description: MoMo payment signature
              example: "a1b2c3d4e5f6g7h8i9j0..."

    FeedbackBase:
      type: object
      properties:
        content:
          type: string
          minLength: 1
          maxLength: 1000
          description: Feedback content
      required:
        - content

    FeedbackCreate:
      allOf:
        - $ref: '#/components/schemas/FeedbackBase'
    
    FeedbackResponse:
      type: object
      properties:
        _id:
          type: string
          format: objectId
          description: Feedback ID
        user_id:
          type: string
          format: objectId
          description: User ID who submitted the feedback
        course_id:
          type: string
          format: objectId
          description: Course ID (if course-specific feedback)
        content:
          type: string
          description: Feedback content
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    FeedbackListResponse:
      type: object
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/FeedbackResponse'
        pagination:
          $ref: '#/components/schemas/PaginationResponse'

    FeedbackDetailResponse:
      type: object
      properties:
        feedback:
          $ref: '#/components/schemas/FeedbackResponse'
        total_courses:
          type: integer
          description: Total number of courses associated with the feedback

    PaginationParams:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          default: 1
          description: Page number for pagination
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 10
          description: Number of items per page
        sort_by:
          type: string
          enum: [created_at, updated_at]
          default: created_at
          description: Field to sort by
        sort_order:
          type: string
          enum: [asc, desc]
          default: desc
          description: Sort order

    CommentBase:
      type: object
      required:
        - content
        - rating
        - is_positive
      properties:
        content:
          type: string
          minLength: 1
          maxLength: 1000
          example: "This lesson was very helpful!"
        rating:
          type: integer
          minimum: 1
          maximum: 5
          example: 5
        is_positive:
          type: boolean
          example: true
        parent_id:
          type: string
          format: string
          description: ID of the parent comment (for replies)
          example: "507f1f77bcf86cd799439011"
        replies:
          type: array
          items:
            type: string
            format: string
          description: List of reply comment IDs
          example: ["507f1f77bcf86cd799439012"]

    CommentResponse:
      type: object
      properties:
        comment_id:
          type: string
          format: string
          example: "507f1f77bcf86cd799439011"
        lesson_id:
          type: string
          format: string
          example: "507f1f77bcf86cd799439012"

    LessonCommentItem:
      type: object
      properties:
        _id:
          type: string
          format: string
          example: "507f1f77bcf86cd799439011"
        user_id:
          type: string
          format: string
          example: "507f1f77bcf86cd799439013"
        course_id:
          type: string
          format: string
          example: "507f1f77bcf86cd799439014"
        lesson_id:
          type: string
          format: string
          example: "507f1f77bcf86cd799439015"
        content:
          type: string
          example: "Great lesson!"
        rating:
          type: integer
          minimum: 1
          maximum: 5
          example: 5
        is_positive:
          type: boolean
          example: true
        parent_id:
          type: string
          format: string
          nullable: true
          example: "507f1f77bcf86cd799439016"
        replies:
          type: array
          items:
            type: string
            format: string
          example: ["507f1f77bcf86cd799439017"]
        created_at:
          type: string
          format: date-time
          example: "2024-03-20T10:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-03-20T10:00:00Z"
        user:
          type: object
          properties:
            _id:
              type: string
              format: string
              example: "507f1f77bcf86cd799439013"
            full_name:
              type: string
              example: "John Doe"
            avatar:
              type: string
              example: "https://example.com/avatar.jpg"

    PaginatedCommentsResponse:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: '#/components/schemas/LessonCommentItem'
        total:
          type: integer
          example: 100
        page:
          type: integer
          minimum: 1
          example: 1
        limit:
          type: integer
          minimum: 1
          maximum: 100
          example: 10
  
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication
